<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Perfil - SheFit</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/perfil.css">
    <link rel="stylesheet" href="css/home.css">
    <link rel="stylesheet" href="css/modals.css">
    <!-- Importar todas as fontes do index.html para consistência -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@200..700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Lilita+One&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=Lilita+One&display=swap" rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100..900;1,100..900&family=Lilita+One&display=swap"
        rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Anton&family=Exo+2:ital,wght@0,100..900;1,100..900&family=Montserrat:ital,wght=0,900;1,900&display=swap"
        rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Anton&family=Exo+2:ital,wght@0,100..900;1,100..900&family=Montserrat:ital,wght=1,900&family=Playpen+Sans:wght@100..800&display=swap"
        rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Big+Shoulders+Inline:opsz,wght@10..72,100..900&family=Emblema+One&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Big+Shoulders+Inline:opsz,wght@10..72,100..900&family=Emblema+One&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Mulish:ital,wght@0,200..1000;1,200..1000&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
</head>

<body>
   <body>
  <div class="navbar">
    <div class="header-inner-content">

      <!-- Ícone do menu hambúrguer (aparece só no mobile) -->
      <div class="hamburger" id="hamburger">
        ☰
      </div>
      <h1 class="logo">
        <a href="index">
          <img class="logo2" src="../img/Design sem nome (3)-Photoroom.png" alt="Logo da Shefit" />
        </a>
      </h1>



      <nav class="main-nav">
        <ul>
          <li data-content="produtos">Produtos</li>
          <li data-content="contato">Contato</li>
          <li data-content="sobre">Sobre</li>
        </ul>
      </nav>

      <div class="nav-icon-container">
        <a href="carrinho"><img src="../img/cartt.png" alt="Carrinho"></a>
        <a href="#" onclick="document.getElementById('login-modal1').style.display='block'" class="login-button" id="login-btn-link">Login</a>
            <span id="user-name" style="display:none; cursor:pointer; font-weight: bold;"></span>
            <a href="#" onclick="logout()" id="logout-btn" style="display:none; margin-left: 10px;">Sair</a>
        
      </div>

    </div>

    <main>
        <div class="profile-container">
            <h1>Meu Perfil</h1>
            <div id="profile-message" class="alert"></div>

            <div class="profile-section">
                <h2>Informações Pessoais e Endereço</h2>
                <form id="profile-form" class="profile-form">
                    <input type="hidden" id="user-id" name="id">

                    <div class="form-group">
                        <label for="name">Nome Completo</label>
                        <input type="text" id="name" name="name" required>
                    </div>

                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" disabled>
                    </div>

                    <div class="form-group">
                        <label for="cpf">CPF</label>
                        <input type="text" id="cpf" name="cpf" maxlength="14" disabled>
                    </div>

                    <div class="form-group">
                        <label for="phone">Telefone</label>
                        <input type="text" id="phone" name="phone" maxlength="15">
                    </div>

                    <div class="form-group">
                        <label for="cep">CEP</label>
                        <input type="text" id="cep" name="cep" maxlength="8">
                    </div>

                    <div class="form-group">
                        <label for="street">Rua</label>
                        <input type="text" id="street" name="street">
                    </div>

                    <div class="form-group">
                        <label for="neighborhood">Bairro</label>
                        <input type="text" id="neighborhood" name="neighborhood">
                    </div>

                    <div class="form-group">
                        <label for="city">Cidade</label>
                        <input type="text" id="city" name="city">
                    </div>

                    <div class="form-group">
                        <label for="state">Estado</label>
                        <input type="text" id="state" name="state">
                    </div>

                    <button type="submit">Salvar Alterações</button>
                </form>
            </div>

            <div class="profile-section">
                <h2>Alterar Senha</h2>
                <div id="password-message" class="alert"></div>
                <form id="password-form" class="profile-form">
                    <div class="form-group">
                        <label for="current-password">Senha Atual</label>
                        <input type="password" id="current-password" name="current-password" required>
                    </div>

                    <div class="form-group">
                        <label for="new-password">Nova Senha</label>
                        <input type="password" id="new-password" name="new-password" required>
                    </div>

                    <div class="form-group">
                        <label for="confirm-password">Confirmar Nova Senha</label>
                        <input type="password" id="confirm-password" name="confirm-password" required>
                    </div>

                    <button type="submit">Alterar Senha</button>
                </form>
            </div>
        </div>
    </main>

    <!-- Footer (Simulação de Footer para consistência) -->
    <footer style="background-color: #333; color: white; text-align: center; padding: 20px; margin-top: 50px;">
        <p>&copy; 2024 SheFit. Todos os direitos reservados.</p>
    </footer>

    <script src="js/auth-completo.js"></script>
    <script>
        // Funções de busca e atualização de perfil serão adicionadas ao auth-completo.js
        // A lógica aqui apenas chama as funções globais.
        document.addEventListener('DOMContentLoaded', () => {
            // Verifica se o usuário está logado
            const user = JSON.parse(localStorage.getItem('user'));
            if (!user) {
                alert('Você precisa estar logado para acessar esta página.');
                window.location.href = 'index'; // Redireciona para /index (que é /)
                return;
            }

            // Carrega os dados do perfil
            loadUserProfile(user.id);

            // Adiciona listeners aos formulários
            document.getElementById('profile-form').addEventListener('submit', handleProfileUpdate);
            document.getElementById('password-form').addEventListener('submit', handlePasswordUpdate);

            // Adiciona listener para busca de CEP
            document.getElementById('cep').addEventListener('blur', (e) => {
                // Reutiliza a função searchCEP do auth-completo.js
                searchCEP(e.target.value, {
                    street: 'street',
                    neighborhood: 'neighborhood',
                    city: 'city',
                    state: 'state'
                });
            });
        });
    </script>
</body>

</html>